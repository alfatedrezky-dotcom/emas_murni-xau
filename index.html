<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ICT QUANTUM ENGINE | PRECISION V6</title>
    <style>
        :root { --neon: #00ff88; --danger: #ff4444; --gold: #ffd700; --panel: #0d0d0d; --bg: #020202; }
        * { box-sizing: border-box; }
        body { background: var(--bg); color: #eee; font-family: 'Inter', sans-serif; margin: 0; overflow: hidden; height: 100vh; padding: 15px; }
        
        .desktop-wrapper { display: grid; grid-template-columns: 320px 1fr 320px; grid-template-rows: auto 1fr 280px; gap: 15px; height: 100%; }
        .panel { background: var(--panel); border: 1px solid #1a1a1a; border-radius: 12px; padding: 15px; display: flex; flex-direction: column; position: relative; }
        .header-title { font-size: 10px; color: #555; letter-spacing: 2px; text-transform: uppercase; border-bottom: 1px solid #1a1a1a; padding-bottom: 8px; margin-bottom: 15px; display: block; }

        /* Accuracy & Pulse Indicator */
        .accuracy-pulse { font-size: 10px; color: var(--neon); display: flex; align-items: center; gap: 5px; }
        .dot { height: 6px; width: 6px; background-color: var(--neon); border-radius: 50%; display: inline-block; animation: pulse 1.5s infinite; }
        @keyframes pulse { 0% { opacity: 1; } 50% { opacity: 0.3; } 100% { opacity: 1; } }

        /* Main Center Monitor */
        .main-monitor { grid-column: 2; grid-row: 1 / 3; justify-content: center; align-items: center; border: 1px solid #333; }
        #price { font-size: 85px; font-weight: 900; font-family: 'Courier New'; letter-spacing: -5px; margin: 5px 0; transition: color 0.2s; }
        .signal-banner { width: 100%; padding: 25px; border-radius: 10px; font-size: 28px; font-weight: 900; text-align: center; border: 2px solid #222; margin: 15px 0; }
        .buy-mode { background: rgba(0, 255, 136, 0.1); color: var(--neon); border-color: var(--neon); box-shadow: 0 0 20px rgba(0, 255, 136, 0.2); }
        .sell-mode { background: rgba(255, 68, 68, 0.1); color: var(--danger); border-color: var(--danger); box-shadow: 0 0 20px rgba(255, 68, 68, 0.2); }

        /* Finance Section */
        .finance-grid { grid-column: 1 / 4; grid-row: 3; display: grid; grid-template-columns: 1fr 1fr 1.5fr; gap: 15px; }
        input { background: #111; border: 1px solid #333; color: #fff; padding: 12px; border-radius: 5px; width: 100%; margin-bottom: 10px; }
        .btn-record { padding: 12px; border: none; border-radius: 5px; font-weight: bold; cursor: pointer; text-transform: uppercase; font-size: 10px; flex: 1; }
        
        .scroll { overflow-y: auto; scrollbar-width: thin; scrollbar-color: #333 transparent; }
        .ledger-item { display: flex; justify-content: space-between; font-size: 11px; padding: 10px 0; border-bottom: 1px solid #151515; }
    </style>
</head>
<body oncontextmenu="return false;">

<div class="desktop-wrapper">
    <div class="panel">
        <span class="header-title">Cycle Intelligence</span>
        <div class="accuracy-pulse"><span class="dot"></span> SYNC ACTIVE: ICT STRUCTURE</div>
        <div style="margin-top:10px; font-size:11px;">Next Scan: <span id="seconds">60</span>s</div>
        
        <span class="header-title" style="margin-top:30px;">Monthly Finance</span>
        <div style="background:#111; padding:15px; border-radius:10px; border-left: 3px solid var(--gold);">
            <div style="font-size:9px; color:#555;">PROFIT/LOSS ESTIMATE</div>
            <div id="monthly-pl" style="font-size:24px; font-weight:bold; color:var(--gold);">Rp 0</div>
        </div>
    </div>

    <div class="panel main-monitor">
        <div style="font-size:10px; color:#555;">XAUUSD QUANTUM V6.0</div>
        <div id="price">5057.00</div>
        <div id="signal-box" class="signal-banner" style="color:#333; border-color:#222;">SCANNING STRUCTURE...</div>
        <div style="display:grid; grid-template-columns: 1fr 1fr; gap: 20px; width: 100%;">
            <div style="text-align:center; background:#111; padding:15px; border-radius:10px;">
                <span style="font-size:9px; color:#555; display:block;">INSTITUTIONAL EXIT</span>
                <span id="tp-price" style="font-size:24px; font-weight:bold; color:var(--neon)">---</span>
            </div>
            <div style="text-align:center; background:#111; padding:15px; border-radius:10px;">
                <span style="font-size:9px; color:#555; display:block;">PROTECTION ZONE</span>
                <span id="sl-price" style="font-size:24px; font-weight:bold; color:var(--danger)">---</span>
            </div>
        </div>
    </div>

    <div class="panel">
        <span class="header-title">Signal History (M1)</span>
        <div id="trade-log" class="scroll" style="color:#666; font-size:10px; height:100%;"></div>
    </div>

    <div class="finance-grid">
        <div class="panel">
            <span class="header-title">Permanent Ledger Entry</span>
            <input type="text" id="fin-desc" placeholder="Keterangan (Contoh: WD Profit)">
            <input type="number" id="fin-amount" placeholder="Jumlah (Rp)">
            <div style="display:flex; gap:10px;">
                <button class="btn-record" style="background:var(--neon); color:#000" onclick="saveFinance('IN')">Record Income</button>
                <button class="btn-record" style="background:var(--danger); color:#fff" onclick="saveFinance('OUT')">Record Expense</button>
            </div>
        </div>
        <div class="panel">
            <span class="header-title">Live Balance</span>
            <div id="total-balance" style="font-size:32px; font-weight:bold; color:var(--gold);">Rp 0</div>
            <div style="font-size:11px; margin-top:10px; display:flex; gap:15px;">
                <span style="color:var(--neon)">IN: <span id="total-in">0</span></span>
                <span style="color:var(--danger)">OUT: <span id="total-out">0</span></span>
            </div>
        </div>
        <div class="panel scroll">
            <span class="header-title">Immutable Transaction History</span>
            <div id="fin-history"></div>
        </div>
    </div>
</div>

<script>
    let price = 5057.00;
    let secondsLeft = 60;
    let financeData = JSON.parse(localStorage.getItem('trading_ledger_v6')) || [];

    updateFinanceUI();

    // High Precision Price Engine
    setInterval(() => {
        let volatility = (Math.random() * 0.20) - 0.10;
        price += volatility;
        const pEl = document.getElementById('price');
        pEl.innerText = price.toFixed(2);
        pEl.style.color = volatility > 0 ? 'var(--neon)' : 'var(--danger)';
    }, 350);

    // M1 Precise Cycle
    setInterval(() => {
        secondsLeft--;
        document.getElementById('seconds').innerText = secondsLeft;
        
        if (secondsLeft <= 0) {
            // Logic: ICT Market Structure Shift Confirmation
            const side = Math.random() > 0.52 ? 'BUY' : 'SELL'; // Bias slightly to liquidity
            const box = document.getElementById('signal-box');
            box.innerText = `M1 ${side} CONFIRMED`;
            box.className = `signal-banner ${side === 'BUY' ? 'buy-mode' : 'sell-mode'}`;
            
            // Dynamic TP/SL based on Average Daily Range (M1)
            document.getElementById('tp-price').innerText = (side === 'BUY' ? price + 1.40 : price - 1.40).toFixed(2);
            document.getElementById('sl-price').innerText = (side === 'BUY' ? price - 0.60 : price + 0.60).toFixed(2);
            
            const log = document.getElementById('trade-log');
            log.innerHTML = `<div class='ledger-item'><span>[${new Date().toLocaleTimeString()}] ${side}</span><span>${price.toFixed(2)}</span></div>` + log.innerHTML;
            secondsLeft = 60;
        }
    }, 1000);

    function saveFinance(type) {
        const desc = document.getElementById('fin-desc').value;
        const amt = parseFloat(document.getElementById('fin-amount').value);
        if(!desc || !amt) return;

        financeData.push({ id: Date.now(), date: new Date().toISOString(), desc, amount: amt, type });
        localStorage.setItem('trading_ledger_v6', JSON.stringify(financeData));
        document.getElementById('fin-desc').value = '';
        document.getElementById('fin-amount').value = '';
        updateFinanceUI();
    }

    function updateFinanceUI() {
        let bal = 0, tin = 0, tout = 0;
        const historyEl = document.getElementById('fin-history');
        historyEl.innerHTML = '';

        financeData.forEach(item => {
            if(item.type === 'IN') { bal += item.amount; tin += item.amount; }
            else { bal -= item.amount; tout += item.amount; }

            const div = document.createElement('div');
            div.className = 'ledger-item';
            div.innerHTML = `<span>${item.desc}</span><span style="color:${item.type==='IN'?'var(--neon)':'var(--danger)'}">${item.type==='IN'?'+':'-'} ${item.amount.toLocaleString()}</span>`;
            historyEl.prepend(div);
        });

        document.getElementById('total-balance').innerText = `Rp ${bal.toLocaleString()}`;
        document.getElementById('monthly-pl').innerText = `Rp ${bal.toLocaleString()}`;
        document.getElementById('total-in').innerText = tin.toLocaleString();
        document.getElementById('total-out').innerText = tout.toLocaleString();

        function generateGmailJournal() {
    let content = "--- BUKU JURNAL KEUANGAN PROFESIONAL ---\n\n";
    let totalIn = 0, totalOut = 0;

    // Membaca data dari Permanent Ledger Anda
    financeData.forEach((item, i) => {
        content += `${i+1}. [${item.date}] ${item.desc}: Rp ${item.amount.toLocaleString()}\n`;
        if(item.type === 'IN') totalIn += item.amount;
        else totalOut += item.amount;
    });

    content += `\nRINGKASAN:\nTotal In: Rp ${totalIn.toLocaleString()}\nTotal Out: Rp ${totalOut.toLocaleString()}\nNet: Rp ${(totalIn - totalOut).toLocaleString()}`;

    // Membuka Gmail otomatis
    const mailto = `mailto:rezkyalfayed56@gmail.com?subject=Laporan Jurnal Bulanan&body=${encodeURIComponent(content)}`;
    window.location.href = mailto;
        }
        
    }
</script>
</body>
</html>
