<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <title>SMC GOD PROTOCOL V3.8 - NEWS ALERT</title>
    <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-database.js"></script>
    <link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@400;700&display=swap" rel="stylesheet">
    <style>
        :root { --gold: #ffd700; --green: #00ff88; --red: #ff3333; --bg: #000; }
        body { margin: 0; background: var(--bg); color: #fff; font-family: 'Segoe UI', sans-serif; height: 100vh; display: flex; flex-direction: column; overflow: hidden; }
        
        /* News Ticker / Running Text */
        .news-ticker { background: #b08d00; color: #000; height: 25px; display: flex; align-items: center; font-size: 11px; font-weight: bold; overflow: hidden; border-bottom: 1px solid #000; }
        .ticker-wrap { width: 100%; overflow: hidden; white-space: nowrap; }
        .ticker-move { display: inline-block; animation: ticker 30s linear infinite; }
        @keyframes ticker { 0% { transform: translateX(100%); } 100% { transform: translateX(-100%); } }

        .header-bar { height: 45px; background: #111; display: flex; align-items: center; padding: 0 20px; border-bottom: 1px solid #222; justify-content: space-between; }
        .main-container { display: flex; flex: 1; overflow: hidden; }
        .chart-section { flex: 3; position: relative; border-right: 2px solid #1a1a1a; }
        .news-section { flex: 1; background: #050505; min-width: 300px; display: flex; flex-direction: column; }
        
        /* Footer UI */
        .footer { height: 160px; background: #050505; display: flex; padding: 10px; gap: 10px; border-top: 2px solid #1a1a1a; }
        .price-card { flex: 1; background: #0a0a0a; border: 1px solid #333; border-radius: 12px; display: flex; flex-direction: column; align-items: center; justify-content: center; position: relative; }
        .log-terminal { flex: 2; background: #000; border: 1px solid #1a1a1a; padding: 10px; font-size: 11px; font-family: 'Courier New', monospace; color: var(--green); overflow-y: auto; }
        
        #price { font-size: 40px; color: var(--gold); font-family: 'Orbitron'; margin: 0; }
        .test-btn { padding: 6px 12px; background: var(--gold); border: none; border-radius: 4px; cursor: pointer; font-weight: bold; font-size: 10px; }
        
        /* Flash Animations */
        .flash-buy { box-shadow: inset 0 0 80px #00ff8855; transition: 0.3s; }
        .flash-sell { box-shadow: inset 0 0 80px #ff333355; transition: 0.3s; }
    </style>
</head>
<body id="body-main">

<div class="news-ticker">
    <div class="ticker-wrap">
        <div class="ticker-move" id="ticker-text">
            WARNING: HIGH IMPACT NEWS AHEAD (CPI, NFP, FOMC) - ALWAYS CHECK THE ECONOMIC CALENDAR BEFORE TRADING - VOLATILITY MAY INCREASE - TRADE RESPONSIBLY...
        </div>
    </div>
</div>

<div class="header-bar">
    <div style="font-family: 'Orbitron'; font-size: 14px; color: var(--gold);">SMC GOD PROTOCOL <span style="font-size: 10px; color: #666;">V3.8</span></div>
    <div style="display: flex; align-items: center;">
        <div id="session-info" style="font-size: 10px; color: var(--gold); padding: 3px 8px; border: 1px solid #333; border-radius: 4px;">SYNCING...</div>
        <button class="test-btn" style="margin-left: 15px;" onclick="testSound()">TEST ALARM</button>
    </div>
</div>

<div class="main-container">
    <div class="chart-section" id="chart-area">
        <iframe src="https://s.tradingview.com/widgetembed/?symbol=OANDA%3AXAUUSD&interval=1&theme=dark" style="width:100%; height:100%; border:none;"></iframe>
    </div>
    <div class="news-section">
        <div style="padding: 10px; font-size: 11px; background: #111; color: var(--gold); font-weight: bold;">LIVE MARKET DATA</div>
        <iframe id="news-iframe" src="https://www.widgets.investing.com/live-currency-cross-rates?theme=darkTheme&pairs=1" width="100%" height="100%" frameborder="0" allowtransparency="true"></iframe>
    </div>
</div>

<div class="footer">
    <div class="price-card" id="card-main">
        <div id="bias-val" style="font-size: 10px; letter-spacing: 2px; margin-bottom: 5px;">CONNECTING...</div>
        <div id="price">0.00</div>
        <div id="signal" style="margin-top:5px; font-weight:bold; font-size: 13px; color: #555;">WAITING DATA</div>
        <div id="timer" style="position: absolute; bottom: 8px; right: 12px; font-size: 10px; color: var(--gold); font-family: 'Orbitron';">00s</div>
    </div>
    <div class="log-terminal" id="log"></div>
</div>

<script>
    const firebaseConfig = { databaseURL: "https://emas-murni-xau-default-rtdb.firebaseio.com" };
    firebase.initializeApp(firebaseConfig);
    const db = firebase.database();

    const audioBuy = new Audio('https://actions.google.com/sounds/v1/alarms/beep_short.ogg');
    const audioSell = new Audio('https://actions.google.com/sounds/v1/alarms/digital_watch_alarm_long.ogg');

    function testSound() { audioBuy.play(); alert("Sistem Audio & News Alert Aktif!"); }

    // Session Tracker
    function updateSession() {
        const hour = new Date().getUTCHours();
        let session = "ASIA SESSION";
        if (hour >= 7 && hour < 16) session = "LONDON SESSION ðŸ‡¬ðŸ‡§";
        if (hour >= 13 && hour < 22) session = "NEW YORK SESSION ðŸ‡ºðŸ‡¸";
        document.getElementById('session-info').innerText = session;
    }
    setInterval(updateSession, 60000); updateSession();

    db.ref('live_monitor').on('value', (s) => {
        const d = s.val(); if(!d) return;
        document.getElementById('price').innerText = d.price.toFixed(2);
        document.getElementById('signal').innerText = d.prediction;
        document.getElementById('bias-val').innerText = "BIAS: " + d.bias;
        document.getElementById('bias-val').style.color = d.bias === "BULLISH" ? "var(--green)" : "var(--red)";
        
        const log = document.getElementById('log');
        log.innerHTML = `<div>[${d.time}] ${d.prediction}</div>` + log.innerHTML;
        if(log.children.length > 10) log.removeChild(log.lastChild);
        
        const chartArea = document.getElementById('chart-area');
        chartArea.className = "chart-section";

        if(d.prediction.includes("GOD BUY")) {
            audioBuy.play();
            chartArea.classList.add("flash-buy");
        } else if(d.prediction.includes("GOD SELL")) {
            audioSell.play();
            chartArea.classList.add("flash-sell");
        }
    });

    setInterval(() => {
        const seconds = 60 - new Date().getSeconds();
        document.getElementById('timer').innerText = (seconds < 10 ? "0" : "") + seconds + "s";
    }, 1000);
</script>
</body>
</html>
