<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>XAUUSD REAL-TIME MT5</title>
    <style>
        body { font-family: 'Arial', sans-serif; background: #000; color: #fff; text-align: center; padding: 10px; }
        .mt-container { border: 1px solid #333; display: inline-block; padding: 25px; margin-top: 15px; border-radius: 8px; background: #0d0d0d; min-width: 340px; }
        .header { display: flex; justify-content: space-between; color: #888; font-size: 13px; margin-bottom: 10px; }
        #price { font-size: 55px; font-weight: bold; color: #fff; margin: 10px 0; font-family: 'Courier New', monospace; }
        .signal-box { font-size: 24px; padding: 15px; border-radius: 4px; margin: 15px 0; font-weight: bold; border: 1px solid #444; transition: 0.3s; }
        .buy { background: #005522; color: #00ff88; border-color: #00ff88; }
        .sell { background: #551111; color: #ff4444; border-color: #ff4444; }
        .waiting { color: #555; }
        .levels { display: flex; justify-content: space-between; border-top: 1px solid #333; padding-top: 20px; }
        .lvl-item { width: 48%; }
        .label { font-size: 12px; display: block; margin-bottom: 5px; }
        .tp-color { color: #00ff88; }
        .sl-color { color: #ff4444; }
        .val { font-size: 20px; font-weight: bold; }
    </style>
</head>
<body>

    <div class="mt-container">
        <div class="header">
            <span>XAUUSD, M1</span>
            <span id="status" style="color: #00ff88;">‚óè Live</span>
        </div>
        
        <div id="price">0000.00</div>
        
        <div id="signal-box" class="signal-box waiting">SCANNING MARKET...</div>

        <div class="levels">
            <div class="lvl-item">
                <span class="label tp-color">TAKE PROFIT (100)</span>
                <span id="tp-price" class="val tp-color">-</span>
            </div>
            <div class="lvl-item">
                <span class="label sl-color">STOP LOSS (50)</span>
                <span id="sl-price" class="val sl-color">-</span>
            </div>
        </div>
        
        <p style="font-size: 10px; color: #444; margin-top: 20px;">MT5 SYNC: ACTIVE | FIXED SIGNAL MODE</p>
    </div>

    <script>
        let signalLocked = false;
        let lastPrice = 0;

        function connectMarket() {
            // Menggunakan WebSocket Binance untuk harga PAXG/USDT (Emas Digital yang ikut XAUUSD)
            const ws = new WebSocket('wss://stream.binance.com:9443/ws/paxgusdt@ticker');

            ws.onmessage = (event) => {
                let data = JSON.parse(event.data);
                let currentPrice = parseFloat(data.c);
                
                document.getElementById('price').innerText = currentPrice.toFixed(2);

                if (!signalLocked && lastPrice !== 0) {
                    let diff = currentPrice - lastPrice;

                    // Logika Sinyal Akurat (Dipicu oleh pergerakan real-time)
                    if (diff > 0.05) {
                        setSignal("BUY", currentPrice);
                    } else if (diff < -0.05) {
                        setSignal("SELL", currentPrice);
                    }
                }
                lastPrice = currentPrice;
            };

            ws.onerror = () => document.getElementById('status').innerText = "‚óè Error Conn";
        }

        function setSignal(type, entry) {
            const box = document.getElementById('signal-box');
            const tpBox = document.getElementById('tp-price');
            const slBox = document.getElementById('sl-price');

            signalLocked = true; // Sinyal dikunci, tidak akan ganti-ganti lagi

            if (type === "BUY") {
                box.innerText = "ENTRY: BUY üìà";
                box.className = "signal-box buy";
                tpBox.innerText = (entry + 1.00).toFixed(2); // Menetap di 100 pips
                slBox.innerText = (entry - 0.50).toFixed(2); // Menetap di 50 pips
            } else {
                box.innerText = "ENTRY: SELL üìâ";
                box.className = "signal-box sell";
                tpBox.innerText = (entry - 1.00).toFixed(2); 
                slBox.innerText = (entry + 0.50).toFixed(2);
            }
        }

        connectMarket();
    </script>
</body>
</html>
